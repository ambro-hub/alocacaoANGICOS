<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consulta de Docente</title>
    <!-- Incluindo o Tailwind CSS para um estilo moderno -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-sm">
        <h1 class="text-3xl font-bold mb-6 text-center text-white">Consulta de Docente, Disciplina, Horário e Local</h1>
        
        <!-- Campo de entrada para o nome do docente -->
        <div class="mb-4">
            <label for="nameInput" class="block text-sm font-medium text-gray-400 mb-2">Digite o nome do(a) docente:</label>
            <input type="text" id="nameInput" placeholder="Ex: João Silva" class="w-full px-4 py-2 rounded-lg bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500">
        </div>
        
        <!-- Botão para consultar -->
        <button id="searchButton" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-purple-500">
            Consultar
        </button>
        
        <!-- Área para exibir o resultado -->
        <div id="result" class="mt-6 text-center text-lg font-semibold min-h-[6rem]">
            <!-- O resultado será exibido aqui -->
        </div>
    </div>

    <script>
        // O link da sua planilha publicada foi inserido aqui.
        // A sua planilha deve ter 4 colunas, na seguinte ordem: Disciplina, Docente(s), Horário, Local
        const googleSheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRi8uu5JvF8QAhOE4vsZvJVgxZ-wRYBQE_okc-lV5rLluzEA1OhmlsrZg0OoWRHC2g-EmwtSwVMIwXp/pub?output=csv';

        // Mapeamento de nomes para as informações (Disciplina, Horário, Local). Inicialmente vazio.
        let data = {};
        
        // Selecionando os elementos do DOM
        const nameInput = document.getElementById('nameInput');
        const searchButton = document.getElementById('searchButton');
        const resultDisplay = document.getElementById('result');

        /**
         * Carrega os dados da planilha do Google Sheets.
         */
        async function loadDataFromSheet() {
            resultDisplay.innerHTML = '<p class="text-yellow-400">Carregando dados da planilha...</p>';
            searchButton.disabled = true;

            try {
                const response = await fetch(googleSheetUrl);
                const csvText = await response.text();

                // Processa o texto CSV para construir o objeto de dados
                const rows = csvText.split('\n');
                
                // Ignora o cabeçalho se houver
                const dataRows = rows.slice(1);
                
                for (const row of dataRows) {
                    const columns = row.split(',');
                    // Verifica se há pelo menos 4 colunas
                    if (columns.length >= 4) {
                        const subject = columns[0].trim();
                        const name = columns[1].trim().toLowerCase();
                        const schedule = columns[2].trim();
                        const classroom = columns[3].trim();
                        // Armazena os dados, usando o nome do docente como chave
                        data[name] = { classroom: classroom, subject: subject, schedule: schedule };
                    }
                }
                
                resultDisplay.innerHTML = '<p class="text-green-400">Dados carregados com sucesso!</p>';
                // Atualiza o placeholder com o primeiro nome da lista
                nameInput.placeholder = "Ex: " + Object.keys(data)[0];
            } catch (error) {
                console.error('Erro ao carregar os dados da planilha:', error);
                resultDisplay.innerHTML = '<p class="text-red-400">Erro ao carregar os dados. Verifique o link da planilha e se ela está publicada corretamente.</p>';
            } finally {
                searchButton.disabled = false;
            }
        }

        /**
         * Realiza a busca pelas informações com base no nome do docente.
         */
        function searchDocente() {
            const name = nameInput.value.trim().toLowerCase();

            if (name === '') {
                resultDisplay.innerHTML = '<p class="text-yellow-400">Por favor, digite um nome.</p>';
                return;
            }

            const personData = data[name];

            if (personData) {
                resultDisplay.innerHTML = `
                    <p class="text-green-400 font-bold">Disciplina:</p>
                    <p class="text-white">${personData.subject}</p>
                    <p class="text-green-400 font-bold mt-2">Horário:</p>
                    <p class="text-white">${personData.schedule}</p>
                    <p class="text-green-400 font-bold mt-2">Local:</p>
                    <p class="text-white">${personData.classroom}</p>
                `;
            } else {
                resultDisplay.innerHTML = '<p class="text-red-400">Nome não encontrado.</p>';
            }
        }

        // Adiciona um ouvinte de evento para o clique no botão
        searchButton.addEventListener('click', searchDocente);

        // Adiciona um ouvinte para a tecla 'Enter' no campo de entrada
        nameInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                searchDocente();
            }
        });

        // Carrega os dados da planilha quando a página é carregada
        window.addEventListener('load', loadDataFromSheet);
    </script>
</body>
</html>
